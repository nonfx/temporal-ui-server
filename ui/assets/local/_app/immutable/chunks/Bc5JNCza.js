import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as st,l as C,a as ot,b as rt,s as n,m,R as p,ah as at,g as t,r as G,f as nt,e as ct,d as ut}from"./DYX0w8bX.js";import{e as lt}from"./B8vPeB6P.js";import{t as L,a as q,c as it}from"./Bz76f8pg.js";import{i as ft}from"./B_BuKjdB.js";import{e as mt}from"./CgLBepva.js";import{i as pt}from"./CZRFLhJG.js";import{p as wt}from"./BrXzBH3h.js";import{s as dt,e as F,a as w,b as ht}from"./CgU0heln.js";import{a as vt}from"./DsexP6Wk.js";import{p as kt}from"./DeZDeXIv.js";import{S as yt}from"./D8oqToDd.js";import{w as I,q as _t,r as gt,b as D,d as xt}from"./PS3yGIAW.js";import{w as K}from"./Yt85EdFy.js";import{c as St}from"./DDAxnLud.js";import{S as Ct}from"./S6Q2Q0ub.js";import{w as N,t as It,c as Wt}from"./Cuael8pi.js";import{b as bt}from"./DcRXFRei.js";import{u as $t}from"./D__G27--.js";import{W as Et}from"./BNr3lY2V.js";const Y=(i=[])=>i.map(o=>{const s=bt(o==null?void 0:o.groupValues[0]),k=parseInt(o.count);return{status:s,count:k}}).sort((o,s)=>N.indexOf(o.status)-N.indexOf(s.status)),H=(i,o,s)=>{const u=Math.pow(3600/i,1/s),y=i*Math.pow(u,o);return Math.min(3600,Math.round(y))};var Pt=L("<button><!></button>"),qt=L('<div class="flex min-h-[24px] flex-wrap items-center gap-2"></div>');function Zt(i,o){st(o,!1);const[s,k]=dt(),u=()=>w(kt,"$page",s),y=()=>w(_t,"$queryWithParentWorkflowId",s),c=()=>w(I,"$workflowCount",s),U=()=>w(xt,"$disableWorkflowCountsRefresh",s),W=()=>w(K,"$workflowFilters",s),R=()=>w(gt,"$refresh",s),d=m(),h=m(),b=m();let B=wt(o,"staticQuery",8,""),Q=m([]),_=m([]),g,v=1,x=m(!1);const A=5,$=100;vt(()=>{M()});const V=()=>{if(v+=1,clearInterval(g),v<=$){const e=H(A,v,$)*1e3;g=setInterval(()=>O(),e)}},M=()=>{clearInterval(g),n(_,[]),F(I,p(c).newCount=0,p(c)),v=1,n(x,!0)},O=async()=>{V();try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,p(c).newCount=parseInt(e)-c().count,p(c)),n(_,Y(r))}finally{n(x,!1)}},j=async()=>{if(M(),!U()){const e=H(A,v,$)*1e3;g=setInterval(()=>O(),e)}try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,p(c).count=parseInt(e),p(c)),n(Q,Y(r))}finally{n(x,!1)}},z=e=>{if(!W().some(a=>a.attribute==="ExecutionStatus"&&a.value===e)){const a={attribute:"ExecutionStatus",type:Ct.KEYWORD,value:e,operator:"",conditional:"=",parenthesis:""};ht(K,[...W(),a]);const l=It(Wt(W()));$t({url:u().url,parameter:"query",value:l,clearParameters:[St]})}};C(()=>u(),()=>{n(d,u().params.namespace)}),C(()=>(at(B()),y()),()=>{n(h,B()||y())}),C(()=>u(),()=>{n(b,u().url.searchParams.get("per-page"))}),C(()=>(t(d),t(h),t(b),R()),()=>{t(d),t(h),t(b),R(),j()}),ot(),pt();var E=qt();mt(E,5,()=>t(Q),({count:e,status:r})=>r,(e,r)=>{let a=()=>t(r).count,l=()=>t(r).status;var T=it(),J=nt(T);{var X=f=>{var S=Pt(),tt=ct(S);const et=ut(()=>t(_).find(P=>P.status===l())?t(_).find(P=>P.status===l()).count-a():0);Et(tt,{get status(){return l()},get count(){return a()},get newCount(){return t(et)},get"test-id"(){return`workflow-status-${l()??""}`}}),G(S),lt("click",S,()=>z(l())),q(f,S)},Z=f=>{yt(f,{class:"h-6 w-24 rounded-sm"})};ft(J,f=>{t(x)?f(Z,!1):f(X)})}q(e,T)}),G(E),q(i,E),rt(),k()}export{Zt as W};
