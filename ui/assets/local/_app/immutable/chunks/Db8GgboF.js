import{B as f}from"./CoG0geaG.js";import{g as k}from"./BaP1uuNe.js";import{w as A,g as v}from"./DaqIHZoW.js";import{t as C}from"./z4sABeRS.js";import{h as b}from"./BqNaQ_Wm.js";import{i as R}from"./DOIkg3zK.js";import{s as $,t as F}from"./dAqOlFj6.js";import{i as O}from"./sn2861XU.js";import{b as W}from"./B5CyelYt.js";import{p as I}from"./BlTZtavH.js";const j=A(null),P=(i,n=C,o=j,c=f)=>{if(!(i instanceof DOMException&&i.name==="AbortError"))throw typeof i=="string"?n.push({variant:"error",message:i}):i.report=!1,i instanceof Error&&n.push({variant:"error",message:i.message}),T(i)&&c&&window.location.assign($(i==null?void 0:i.message)),x(i)&&c&&window.location.assign($(i==null?void 0:i.message)),R(i)&&(n.push({variant:"error",message:`${i.statusCode} ${i.statusText}`}),o.set(i)),i},cn=(i,n=f)=>{var c;const o=`${i==null?void 0:i.status} ${(c=i==null?void 0:i.body)==null?void 0:c.message}`;if(T(i)&&n){window.location.assign($(o));return}if(x(i)&&n){window.location.assign($(o));return}},T=i=>U(i,401),x=i=>U(i,403),U=(i,n)=>b(i,"statusCode")?i.statusCode===n:b(i,"status")?i.status===n:!1,sn=async(i,n={})=>{const{params:o={},request:c=fetch,token:l,notifyOnError:s=!0,handleError:u=P,onError:e,isBrowser:g=f}=n;let{options:w}=n,h=new URLSearchParams;if(o!=null&&o.entries)h=o,l&&h.set("nextPageToken",l);else{const t=l?{next_page_token:l}:{};h=new URLSearchParams({...o,...t})}const q=F(i,h);try{w=S(w,g),i.endsWith("api/v1/settings")||(w=await z(w,g));const t=await c(q,w),d=await t.json(),{status:N,statusText:E}=t;if(!t.ok)if(e&&O(e))e({status:N,statusText:E,body:d});else throw{statusCode:t.status,statusText:t.statusText,response:t,message:(d==null?void 0:d.message)??t.statusText};return d}catch(t){if(s)u(t);else throw t}},S=(i,n=f)=>{const o={credentials:"include",...i};return o.headers=_(i==null?void 0:i.headers,n),o},z=async(i,n=f)=>(globalThis!=null&&globalThis.AccessToken?i.headers=await y(i==null?void 0:i.headers,globalThis.AccessToken,n):k().accessToken&&(i.headers=await y(i==null?void 0:i.headers,async()=>k().accessToken,n),i.headers=L(i==null?void 0:i.headers,k().idToken,n)),i),y=async(i,n,o=f)=>{if(i||(i={}),!o)return i;try{const c=await n();c&&(i.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return i},L=(i={},n,o=f)=>(o&&n&&(i["Authorization-Extras"]=n),i),_=(i,n=f)=>{if(i||(i={}),i["Caller-Type"]="operator",!n)return i;const o="_csrf=",c="X-CSRF-TOKEN";try{let s=document.cookie.split(";").find(u=>u.includes(o));s&&!i[c]&&(s=s.trim().slice(o.length),i[c]=s)}catch(l){console.error(l)}return i};function B(i=f){const n="",o=!n.startsWith("http");let c="";return o?c=i?window.location.origin+n:"":c=n,c.endsWith("/")&&(c=c.slice(0,-1)),c}const un=(i,n)=>{if(!i||!n)return!1;const[o,c,l]=i.split(".").map(Number),[s,u,e]=n.split(".").map(Number);return o!==s?o>s:c!==u?c>u:l>e},J=(i,n)=>{if(!i||!n)return!1;const[o,c,l]=i.split(".").map(Number),[s,u,e]=n.split(".").map(Number);return o!==s?s>o:c!==u?c===void 0&&u||c===void 0&&u===void 0?!0:u>c:l===void 0&&e||l===void 0&&(e===void 0||isNaN(e))?!0:e>=l},D=(i,n)=>i?i.replace("%namespace%",n):"",H=i=>{var s,u;let n="";const o=(s=v(I).data)==null?void 0:s.webUrl,c=o&&i,l=((u=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:u.apiUrl)&&i;return c?n=o:l?(console.warn("Using fallback api url, web url not found"),n=D(globalThis.AppConfig.apiUrl,i)):n=B(),n.endsWith("/")&&(n=n.slice(0,-1)),n=`${n}${W}`,n},K=i=>(i.startsWith("/")&&(i=i.slice(1)),`/api/v1/${i}`),M=(i,n)=>`${H(n)}${i}`,X=i=>{var o,c,l;const n=(l=(c=(o=v(I))==null?void 0:o.data)==null?void 0:c.settings)==null?void 0:l.version;return Object.keys(i??{}).reduce((s,u)=>(n&&J("2.23.0",n)?s[u]=encodeURIComponent(i[u]):s[u]=encodeURIComponent(encodeURIComponent(i[u])),s),{namespace:"",workflowId:"",scheduleId:"",queue:"",queryType:"",signalName:"",updateName:"",batchJobId:"",runId:"",activityId:"",endpointId:"",deploymentName:"",version:""})};function G(i,n,o=!0){o&&(n=X(n));const c={systemInfo:"/system-info",cluster:"/cluster-info",namespaces:"/namespaces",namespace:`/namespaces/${n==null?void 0:n.namespace}`,"search-attributes":`/namespaces/${n.namespace}/search-attributes`,"events.raw":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/run/${n==null?void 0:n.runId}/history.json`,"events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/history`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/history-reverse`,query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/query/${n.queryType}`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,"schedule.patch":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}/patch`,"schedule.edit":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}/update`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,settings:"/settings","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,"task-queue.compatibility":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}/worker-build-id-compatibility`,"task-queue.rules":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}/worker-versioning-rules`,user:"/me","worker-task-reachability":`/namespaces/${n==null?void 0:n.namespace}/worker-task-reachability`,"workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/terminate`,"workflow.cancel":`/namespaces/${n.namespace}/workflows/${n.workflowId}/cancel`,"workflow.signal":`/namespaces/${n.namespace}/workflows/${n.workflowId}/signal/${n.signalName}`,"workflow.update":`/namespaces/${n.namespace}/workflows/${n.workflowId}/update/${n.updateName}`,"workflow.reset":`/namespaces/${n.namespace}/workflows/${n.workflowId}/reset`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/archived-workflows`,"workflows.count":`/namespaces/${n==null?void 0:n.namespace}/workflow-count`,"activity.complete":`/namespaces/${n.namespace}/activities/complete-by-id`,"activity.fail":`/namespaces/${n.namespace}/activities/fail-by-id`,"activity.pause":`/namespaces/${n.namespace}/activities/pause`,"activity.unpause":`/namespaces/${n.namespace}/activities/unpause`,"activity.reset":`/namespaces/${n.namespace}/activities/reset`,"activity.update-options":`/namespaces/${n.namespace}/activities/update-options`,"batch-operations.list":`/namespaces/${n.namespace}/batch-operations`,"batch-operations":`/namespaces/${n.namespace}/batch-operations/${n==null?void 0:n.batchJobId}`,"nexus-endpoints":"/nexus/endpoints","nexus-endpoint":`/nexus/endpoints/${n.endpointId}`,"nexus-endpoint.update":`/nexus/endpoints/${n.endpointId}/update`,"worker-deployments":`/namespaces/${n.namespace}/worker-deployments`,"worker-deployment":`/namespaces/${n.namespace}/worker-deployments/${n.deploymentName}`,"worker-deployment-version":`/namespaces/${n.namespace}/worker-deployment-versions/${n.version}`};return K(c[i])}function ln(i,n,o=!0){const c=G(i,n,o);return M(c,n==null?void 0:n.namespace)}export{sn as a,H as b,cn as c,T as d,x as e,B as g,P as h,un as i,J as m,G as p,ln as r};
