import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ut,e as r,r as e,b as ct,c as n,t as R,d as i,l as Y,s as E,m as j,ah as $t,a as It,f as k,g as t,n as bt,aM as Mt}from"../chunks/DYX0w8bX.js";import{t as h,a as o,c as st,b as dt}from"../chunks/Bz76f8pg.js";import{i as vt}from"../chunks/CZRFLhJG.js";import{a as lt,s as xt,b as ae}from"../chunks/CgU0heln.js";import{p as Dt}from"../chunks/r-PpyO62.js";import{P as se}from"../chunks/navuEww_.js";import{s as p}from"../chunks/CxFVcq4O.js";import{a as Bt}from"../chunks/BS7N7SXQ.js";import{i as et}from"../chunks/B_BuKjdB.js";import{P as Nt,W as oe}from"../chunks/BWm0djgN.js";import{T as le,a as ie,b as Ht}from"../chunks/B5mSZ4gq.js";import{t as x}from"../chunks/D2OY9xdY.js";import{a as ne,b as de,c as ue,d as ce,e as ve,f as fe,p as _e,h as pe,i as me,j as ge,g as he}from"../chunks/CdOP8HNv.js";import{p as we}from"../chunks/DvmEkM8-.js";import{s as Ct}from"../chunks/CFGOF_JX.js";import{p as rt}from"../chunks/BrXzBH3h.js";import{e as ht,i as kt}from"../chunks/CgLBepva.js";import{c as Yt,s as Ft,a as $e}from"../chunks/BoNO6UAY.js";import{B as xe}from"../chunks/SNXFWeJi.js";import{I as Kt}from"../chunks/BExi9zWc.js";import{t as be}from"../chunks/Ds6tgvmq.js";import{E as yt}from"../chunks/C1XTKaKf.js";import{T as Pt,a as Tt,b as wt}from"../chunks/Csn1rgN-.js";import{f as St,t as zt,r as ke}from"../chunks/DzOyNlRA.js";import"../chunks/Bij_J0Ni.js";import"../chunks/DlxtkSgV.js";import"../chunks/CadMxnDr.js";import"../chunks/Cqkd3idL.js";import{T as Lt}from"../chunks/C5V7NFfp.js";const Ut=we("taskQueueView","workers",!0);var ye=h("<span><!> <!> <!></span>"),Pe=h('<span class="flex items-center gap-1 rounded-sm border border-subtle px-1 text-sm text-primary"><!> </span>'),Te=h('<p class="flex select-all gap-2 font-mono"><!></p>');function qt(J,b){ut(b,!1);let K=rt(b,"defaultVersion",8,!1),X=rt(b,"active",8,!1),B=rt(b,"buildId",8);vt();var g=Te(),Q=r(g);{var V=I=>{var $=ye(),y=r($);Kt(y,{name:"merge"});var D=n(y),u=n(D);Ct(u,b,"overall-default-worker",{},null);var M=n(u,2);Ct(M,b,"default-worker",{},null),e($),R(N=>{Ft($,1,N),p(D,`${B()??""} `)},[()=>Yt(be("flex items-center gap-1 rounded-sm border border-subtle px-1 text-sm text-primary",X()&&"border-green-200 bg-green-200 text-black"))],i),o(I,$)},S=(I,$)=>{{var y=D=>{var u=Pe(),M=r(u);Kt(M,{name:"merge"});var N=n(M,1,!0);e(u),R(()=>p(N,B())),o(D,u)};et(I,D=>{B()&&D(y)},$)}};et(Q,I=>{K()&&B()?I(V):I(S,!1)})}e(g),o(J,g),ct()}var Ie=h('<td class="text-left" data-testid="version-default"><!></td> <td class="text-left" data-testid="version-compatible-builds"><div class="flex flex-wrap gap-2 font-mono"></div></td>',1),Re=h('<tr class="w-full"><td colspan="2"><!></td></tr>'),Qe=h('<th class="w-3/12"> </th> <th class="w-9/12"> </th>',1),Ve=h('<td class="text-left" data-testid="worker-identity"><p class="select-all"><!></p></td> <td class="text-left" data-testid="worker-last-access-time"><p><span> </span></p></td>',1),qe=h('<td class="text-left" data-testid="worker-identity"><p class="select-all"> </p></td> <!> <td class="text-left" data-testid="worker-last-access-time"><p class="select-all"> </p></td> <td data-testid="workflow-poller"><!></td> <td data-testid="activity-poller"><!></td>',1),Be=h('<tr class="w-full"><td><!></td></tr>'),Ce=h('<caption class="sr-only" slot="caption"> </caption>'),Fe=h('<th class="w-3/12"> </th> <th class="w-2/12"> </th>',1),Se=h('<th> </th> <!> <th class="w-2/12"> </th> <th class="w-2/12"><p class="text-center"> </p></th> <th class="w-2/12 text-center"><p class="text-center"> </p></th>',1),De=h('<h2 data-testid="version-sets"> </h2> <!> <h2 class="flex items-center gap-2" data-testid="workers"> <!></h2> <!>',1);function We(J,b){ut(b,!1);const[K,X]=xt(),B=()=>lt(zt,"$timeFormat",K),g=()=>lt(ke,"$relativeTime",K),Q=j(),V=j();let S=rt(b,"taskQueue",8),I=rt(b,"workers",8),$=rt(b,"reachability",8,void 0),y=rt(b,"compatibility",8,void 0);Y(()=>$t(y()),()=>{E(Q,ne(y()))}),Y(()=>$t(y()),()=>{E(V,de(y()))}),It(),vt();var D=De(),u=k(D),M=r(u,!0);e(u);var N=n(u,2);Pt(N,{class:"mb-6 w-full min-w-[600px] table-fixed",children:(w,z)=>{var l=st(),d=k(l);ht(d,1,()=>t(Q),kt,(a,s,c)=>{wt(a,{"data-testid":"version-row",children:(v,f)=>{var _=Ie(),m=k(_),P=r(m);const C=i(()=>ce(t(s).buildIds));qt(P,{defaultVersion:!0,active:c===0,get buildId(){return t(C)},$$slots:{"overall-default-worker":(A,U)=>{var T=st(),O=k(T);{var q=H=>{var G=dt();R(Z=>p(G,Z),[()=>x("workers.overall")],i),o(H,G)};et(O,H=>{c===0&&H(q)})}o(A,T)},"default-worker":(A,U)=>{var T=dt();R(O=>p(T,O),[()=>x("workers.default")],i),o(A,T)}}}),e(m);var F=n(m,2),W=r(F);ht(W,5,()=>ue(t(s).buildIds),kt,(A,U)=>{qt(A,{active:!1,get buildId(){return t(U)},$$slots:{"default-worker":(T,O)=>{var q=dt();R(H=>p(q,H),[()=>x("workers.default")],i),o(T,q)}}})}),e(W),e(F),o(v,_)},$$slots:{default:!0}})},a=>{var s=Re(),c=r(s),v=r(c);const f=i(()=>x("workers.no-version-sets-found"));yt(v,{get title(){return t(f)}}),e(c),e(s),o(a,s)}),o(w,l)},$$slots:{default:!0,headers:(w,z)=>{Tt(w,{slot:"headers",children:(l,d)=>{var a=Qe(),s=k(a),c=r(s,!0);e(s);var v=n(s,2),f=r(v,!0);e(v),R((_,m)=>{p(c,_),p(f,m)},[()=>x("workers.default"),()=>x("workers.compatible-build-ids")],i),o(l,a)},$$slots:{default:!0}})}}});var L=n(N,2),at=r(L),ot=n(at);xe(ot,{type:"count",children:(w,z)=>{bt();var l=dt();R(()=>{var d,a;return p(l,((a=(d=I())==null?void 0:d.pollers)==null?void 0:a.length)||0)}),o(w,l)},$$slots:{default:!0}}),e(L);var tt=n(L,2);Pt(tt,{class:"mb-6 w-full min-w-[600px] table-fixed",children:(w,z)=>{var l=st(),d=k(l);ht(d,1,()=>{var a;return(a=I())==null?void 0:a.pollers},a=>a.identity,(a,s)=>{const c=i(()=>ve(t(s))),v=i(()=>fe($(),S(),t(c)));wt(a,{"data-testid":"worker-row",children:(f,_)=>{var m=qe(),P=k(m),C=r(P),F=r(C,!0);e(C),e(P);var W=n(P,2);{var A=_t=>{var pt=Ve(),nt=k(pt),Wt=r(nt),Gt=r(Wt);const Jt=i(()=>t(c)===t(V)),Xt=i(()=>t(c)===t(V));qt(Gt,{get defaultVersion(){return t(Jt)},get active(){return t(Xt)},get buildId(){return t(c)},$$slots:{"overall-default-worker":(mt,te)=>{var gt=st(),Qt=k(gt);{var ee=Vt=>{var jt=dt();R(re=>p(jt,re),[()=>x("workers.overall")],i),o(Vt,jt)};et(Qt,Vt=>{t(c)===t(V)&&Vt(ee)})}o(mt,gt)},"default-worker":(mt,te)=>{var gt=dt();R(Qt=>p(gt,Qt),[()=>x("workers.default")],i),o(mt,gt)}}}),e(Wt),e(nt);var At=n(nt,2),Ot=r(At),Rt=r(Ot);let Et;var Zt=r(Rt,!0);e(Rt),e(Ot),e(At),R(mt=>{Et=Ft(Rt,1,"svelte-kdqm2r",null,Et,mt),p(Zt,t(v))},[()=>({reachability:!!t(v)})],i),o(_t,pt)};et(W,_t=>{var pt,nt;(nt=(pt=$())==null?void 0:pt.buildIdReachability)!=null&&nt.length&&_t(A)})}var U=n(W,2),T=r(U),O=r(T,!0);e(T),e(U);var q=n(U,2),H=r(q);const G=i(()=>t(s).taskQueueTypes.includes("WORKFLOW"));Nt(H,{get includesTaskQueueType(){return t(G)}}),e(q);var Z=n(q,2),ft=r(Z);const it=i(()=>t(s).taskQueueTypes.includes("ACTIVITY"));Nt(ft,{get includesTaskQueueType(){return t(it)}}),e(Z),R(_t=>{p(F,t(s).identity),p(O,_t)},[()=>St(t(s).lastAccessTime,B(),{relative:g()})],i),o(f,m)},$$slots:{default:!0}})},a=>{var s=Be(),c=r(s),v=r(c);const f=i(()=>x("workflows.workers-empty-state"));yt(v,{get title(){return t(f)}}),e(c),e(s),R(()=>{var _,m;return $e(c,"colspan",(m=(_=$())==null?void 0:_.buildIdReachability)!=null&&m.length?6:4)}),o(a,s)}),o(w,l)},$$slots:{default:!0,caption:(w,z)=>{var l=Ce(),d=r(l,!0);e(l),R(a=>p(d,a),[()=>x("workflows.workers-tab")],i),o(w,l)},headers:(w,z)=>{Tt(w,{slot:"headers",children:(l,d)=>{var a=Se(),s=k(a),c=r(s,!0);e(s);var v=n(s,2);{var f=T=>{var O=Fe(),q=k(O),H=r(q,!0);e(q);var G=n(q,2),Z=r(G,!0);e(G),R((ft,it)=>{p(H,ft),p(Z,it)},[()=>x("workers.version"),()=>x("workers.retirability")],i),o(T,O)};et(v,T=>{var O,q;(q=(O=$())==null?void 0:O.buildIdReachability)!=null&&q.length&&T(f)})}var _=n(v,2),m=r(_,!0);e(_);var P=n(_,2),C=r(P),F=r(C,!0);e(C),e(P);var W=n(P,2),A=r(W),U=r(A,!0);e(A),e(W),R((T,O,q,H)=>{var G,Z;Ft(s,1,Yt((Z=(G=$())==null?void 0:G.buildIdReachability)!=null&&Z.length?"w-3/12":"w-6/12")),p(c,T),p(m,O),p(F,q),p(U,H)},[()=>x("common.id"),()=>x("workflows.last-accessed"),()=>x("workflows.workflow-task-handler"),()=>x("workflows.activity-handler")],i),o(l,a)},$$slots:{default:!0}})}}}),R((w,z)=>{p(M,w),p(at,`${z??""} `)},[()=>x("workers.version-sets"),()=>x("workers.workers")],i),o(J,D),ct(),X()}var Ae=h('<td class="text-left" data-testid="index"></td> <td class="break-all text-left" data-testid="target-build-id"> </td> <td class="text-right" data-testid="target-ramp"> </td> <td class="justfiy-between flex w-full items-center text-right" data-testid="target-create-time"><p> </p></td>',1),Oe=h('<tr class="w-full"><td colspan="4"><!></td></tr>'),Ee=h('<td></td> <td class="break-all text-left text-blue-700 underline"> </td> <td></td> <td></td>',1),je=h("<!> <!>",1),Me=h('<th class="w-20">Index</th> <th class="grow">Target Build ID</th> <th class="w-20">Ramp</th> <th class="text-right">Create Time</th>',1),Ne=h('<td class="text-left" data-testid="target-source"> </td> <td class="text-left" data-testid="target-source"> </td> <td class="text-left" data-testid="target-source"> </td>',1),He=h('<tr class="w-full"><td colspan="3"><!></td></tr>'),Ke=h('<th class="w-1/3">Source Build ID</th> <th class="w-1/3">Target Build ID</th> <th class="w-1/3">Create Time</th>',1),Le=h('<h2 data-testid="worker-rules"> </h2> <!> <h2 data-testid="worker-rules"> </h2> <!>',1);function Ue(J,b){ut(b,!1);const[K,X]=xt(),B=()=>lt(zt,"$timeFormat",K),g=j(),Q=j(),V=j(),S=j(),I=j(),$=j(),y=j();let D=rt(b,"rules",8),u=j(!1);const M=l=>{var d,a,s;return!((d=l.rule)===null||d===void 0)&&d.percentageRamp?!((s=(a=l.rule)===null||a===void 0?void 0:a.percentageRamp)===null||s===void 0)&&s.rampPercentage?l.rule.percentageRamp.rampPercentage:0:100};Y(()=>(t(g),t(Q),$t(D())),()=>{(l=>(E(g,Mt(l.assignmentRules,()=>[],!0)),E(Q,Mt(l.compatibleRedirectRules,()=>[],!0))))(D())}),Y(()=>t(g),()=>{E(V,t(g).find(l=>M(l)===100))}),Y(()=>(t(g),t(V)),()=>{E(S,t(g).indexOf(t(V)))}),Y(()=>(t(g),t(S)),()=>{E(I,t(g).filter((l,d)=>d<=t(S)))}),Y(()=>(t(g),t(S)),()=>{E($,t(g).filter((l,d)=>d>t(S)))}),Y(()=>(t(u),t(I),t($)),()=>{E(y,t(u)?[...t(I),...t($)]:t(I))}),It(),vt();var N=Le(),L=k(N),at=r(L,!0);e(L);var ot=n(L,2);Pt(ot,{class:"mb-6 w-full table-fixed",children:(l,d)=>{var a=je(),s=k(a);ht(s,1,()=>t(y),kt,(f,_,m)=>{wt(f,{"data-testid":"version-row",children:(P,C)=>{var F=Ae(),W=k(F);W.textContent=m;var A=n(W,2),U=r(A,!0);e(A);var T=n(A,2),O=r(T);e(T);var q=n(T,2),H=r(q),G=r(H,!0);e(H),e(q),R((Z,ft)=>{var it;p(U,(it=t(_).rule)==null?void 0:it.targetBuildId),p(O,`${Z??""}%`),p(G,ft)},[()=>M(t(_)).toFixed(0),()=>St(t(_).createTime,B())],i),o(P,F)},$$slots:{default:!0}})},f=>{var _=Oe(),m=r(_),P=r(m);const C=i(()=>x("workers.no-assignment-rules-found"));yt(P,{get title(){return t(C)}}),e(m),e(_),o(f,_)});var c=n(s,2);{var v=f=>{wt(f,{"data-testid":"view-all",class:"surface-subtle cursor-pointer",$$events:{click:()=>E(u,!t(u))},children:(_,m)=>{var P=Ee(),C=n(k(P),2),F=r(C,!0);e(C),bt(4),R(W=>p(F,W),[()=>x("workers.show-inactive-assignment-rules")],i),o(_,P)},$$slots:{default:!0}})};et(c,f=>{var _;!t(u)&&((_=t($))!=null&&_.length)&&f(v)})}o(l,a)},$$slots:{default:!0,headers:(l,d)=>{Tt(l,{slot:"headers",children:(a,s)=>{var c=Me();bt(6),o(a,c)},$$slots:{default:!0}})}}});var tt=n(ot,2),w=r(tt,!0);e(tt);var z=n(tt,2);Pt(z,{class:"mb-6 w-full table-fixed",children:(l,d)=>{var a=st(),s=k(a);ht(s,1,()=>t(Q),kt,(c,v)=>{wt(c,{"data-testid":"version-row",children:(f,_)=>{var m=Ne(),P=k(m),C=r(P,!0);e(P);var F=n(P,2),W=r(F,!0);e(F);var A=n(F,2),U=r(A,!0);e(A),R(T=>{p(C,t(v).rule.sourceBuildId),p(W,t(v).rule.targetBuildId),p(U,T)},[()=>St(t(v).createTime,B())],i),o(f,m)},$$slots:{default:!0}})},c=>{var v=He(),f=r(v),_=r(f);const m=i(()=>x("workers.no-redirect-rules-found"));yt(_,{get title(){return t(m)}}),e(f),e(v),o(c,v)}),o(l,a)},$$slots:{default:!0,headers:(l,d)=>{Tt(l,{slot:"headers",children:(a,s)=>{var c=Ke();bt(4),o(a,c)},$$slots:{default:!0}})}}}),R((l,d)=>{p(at,l),p(w,d)},[()=>x("workers.assignment-rules"),()=>x("workers.redirect-rules")],i),o(J,N),ct(),X()}var Ye=h("<!> <!>",1),ze=h("<p>No versioning configured for task queue.</p>");function Ge(J,b){ut(b,!1);const[K,X]=xt(),B=()=>lt(Dt,"$page",K),g=j(),Q=j(),V=j(),S=j();let I=rt(b,"taskQueue",8),$=rt(b,"workers",8);Y(()=>(t(g),B()),()=>{(u=>E(g,u.namespace))(B().params)}),Y(()=>$t($()),()=>{E(Q,_e($().pollers))}),Y(()=>$t($()),()=>{E(V,pe($().pollers))}),Y(()=>{},()=>{E(S,u=>(u==null?void 0:u.assignmentRules)||(u==null?void 0:u.compatibleRedirectRules))}),It(),vt();var y=st(),D=k(y);Bt(D,()=>me({namespace:t(g),queue:I()}),u=>{Lt(u,{rows:3})},(u,M)=>{var N=i(()=>{var{rules:d,compatibility:a,versionSets:s}=t(M);return{rules:d,compatibility:a,versionSets:s}}),L=i(()=>t(N).rules),at=i(()=>t(N).compatibility),ot=i(()=>t(N).versionSets),tt=st(),w=k(tt);{var z=d=>{Ue(d,{get rules(){return t(L)}})},l=(d,a)=>{{var s=v=>{var f=st(),_=k(f);Bt(_,()=>ge({namespace:t(g),buildIds:t(V),queue:I()}),m=>{Lt(m,{rows:3})},(m,P)=>{var C=Ye(),F=k(C);Ct(F,b,"default",{get compatibility(){return t(at)}},null);var W=n(F,2);We(W,{get taskQueue(){return I()},get workers(){return $()},get compatibility(){return t(at)},get reachability(){return t(P)}}),o(m,C)}),o(v,f)},c=v=>{var f=ze();o(v,f)};et(d,v=>{var f;t(Q)&&((f=t(ot))!=null&&f.length)?v(s):v(c,!1)},a)}};et(w,d=>{t(S)(t(L))?d(z):d(l,!1)})}o(u,tt)}),o(J,y),ct(),X()}var Je=h("<!> <!>",1),Xe=h('<section class="flex flex-col gap-4"><h2 data-testid="task-queue-name"> </h2> <!> <!></section>');function Ze(J,b){ut(b,!1);const[K,X]=xt(),B=()=>lt(Dt,"$page",K),g=()=>lt(Ut,"$taskQueueView",K),Q=j(),V=j(),S=y=>{ae(Ut,y)};Y(()=>(t(Q),t(V),B()),()=>{(y=>(E(Q,y.queue),E(V,y.namespace)))(B().params)}),It(),vt();var I=st(),$=k(I);Bt($,()=>he({queue:t(Q),namespace:t(V)}),null,(y,D)=>{var u=Xe(),M=r(u),N=r(M,!0);e(M);var L=n(M,2);le(L,{children:(w,z)=>{ie(w,{class:"flex flex-wrap gap-6 p-4 pl-0",label:"task queue detail",children:(l,d)=>{var a=Je(),s=k(a);const c=i(()=>x("workers.workers")),v=i(()=>g()==="workers");Ht(s,{get label(){return t(c)},id:"worker-tab",onClick:()=>S("workers"),get active(){return t(v)}});var f=n(s,2);const _=i(()=>x("workers.versioning")),m=i(()=>g()==="versioning");Ht(f,{get label(){return t(_)},id:"versioning-tab",onClick:()=>S("versioning"),get active(){return t(m)}}),o(l,a)},$$slots:{default:!0}})},$$slots:{default:!0}});var at=n(L,2);{var ot=w=>{Ge(w,{get taskQueue(){return t(Q)},get workers(){return t(D)}})},tt=w=>{oe(w,{get workers(){return t(D)}})};et(at,w=>{g()==="versioning"?w(ot):w(tt,!1)})}e(u),R(()=>p(N,t(Q))),o(y,u)}),o(J,I),ct(),X()}var tr=h("<!> <!>",1);function Br(J,b){ut(b,!1);const[K,X]=xt(),B=()=>lt(Dt,"$page",K),g=B().params.queue;vt();var Q=tr(),V=k(Q);se(V,{title:`Task Queue | ${g}`,get url(){return B().url.href}});var S=n(V,2);Ze(S,{}),o(J,Q),ct(),X()}export{Br as component};
