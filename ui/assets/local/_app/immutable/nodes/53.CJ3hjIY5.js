import{r as pt}from"../chunks/hUONLBj8.js";import{e as Re,c as Fe,i as mt}from"../chunks/BdSHaNVs.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ze,l as J,a as vt,t as P,h as u,c as s,r as c,d as f,b as Be,n as E,k as re,i as C,j as l,g as e,f as D,s as r,m as i,e as wt}from"../chunks/DSxqszTl.js";import{i as He}from"../chunks/BcaHj5WR.js";import{s as Je,d as gt,a as oe}from"../chunks/CZBNCVvj.js";import{p as Ue}from"../chunks/Df7rYi0q.js";import{P as _t}from"../chunks/DTWo_ajL.js";import{s as W}from"../chunks/CXaSvchK.js";import{i as de}from"../chunks/BAt4aHTa.js";import{o as $t,w as kt}from"../chunks/Cb3VdkNs.js";import{C as xt}from"../chunks/B8jpWHZy.js";import{P as ht,s as yt,e as bt,g as It}from"../chunks/p1pef5nX.js";import{A as Pt}from"../chunks/B8WusR0w.js";import{A as Oe}from"../chunks/DlVC6YhT.js";import{B as he}from"../chunks/rRbRIrsH.js";import{C as fe}from"../chunks/BCh4NEuC.js";import{I as Ne}from"../chunks/Dc8cZy7F.js";import{I as pe}from"../chunks/CTI-nDHL.js";import{L as ye}from"../chunks/LntrTj2C.js";import{L as be}from"../chunks/BlzQnGKV.js";import{E as Le}from"../chunks/CcUlTmW2.js";import{T as Tt}from"../chunks/CFAn1g9i.js";import{t as d}from"../chunks/D2OY9xdY.js";import{g as St}from"../chunks/Dto_CGeq.js";import{c as At}from"../chunks/80RifD-7.js";import{t as Ve}from"../chunks/DjXfOCsk.js";import{g as Wt}from"../chunks/DxrQv2F8.js";import{c as Qt,d as jt}from"../chunks/CeMbHz9m.js";import{p as Et}from"../chunks/756y7qLl.js";import{u as qe}from"../chunks/DZkJnz51.js";import{w as Ct}from"../chunks/BlggzWwk.js";import{v as Dt}from"../chunks/Dz_GI0CC.js";const Ft=async function({params:U,parent:K}){var n,F;const v=await K();if(((n=v==null?void 0:v.settings)==null?void 0:n.disableWriteActions)||((F=v==null?void 0:v.settings)==null?void 0:F.startWorkflowDisabled)){const{namespace:O}=U;pt(302,Re({namespace:O}))}},Sr=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));var Ot=P('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Nt=P(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Lt=P('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Vt=P(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),qt=P("<!> <!> <!>",1),Rt=P("<!> ",1),zt=P('<div class="mt-2"><!></div>'),Bt=P('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Ht=P('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function Jt(U,K){ze(K,!1);const[v,se]=Je(),n=()=>oe(Ue,"$page",v),F=()=>oe(e(ne),"$encoding",v),O=()=>oe(At,"$customSearchAttributes",v),me=()=>oe(It,"$workflowsSearchParams",v),T=i(),M=i(),ve=i(),we=i(),Ie=i(),Ke=Wt();let S=i(""),N=i(""),R=i(""),L=i(""),ae=i(""),le=i(""),ne=i(kt("json/plain")),ie=i(""),G=i(""),ge="",_e="",z=i(""),B=i(void 0),X=i(!1),Y=i([]);function Me(a){var _,p;if(!a)return{};const o=a.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!o)return{};const V=(_=o[1])===null||_===void 0?void 0:_.trim(),Q=(p=o[2])===null||p===void 0?void 0:p.trim();return!V||!Q?{}:{workflowId:V,runId:Q}}$t(()=>{r(S,n().url.searchParams.get("workflowId")||""),r(N,n().url.searchParams.get("taskQueue")||""),r(R,n().url.searchParams.get("workflowType")||""),ge=n().url.searchParams.get("workflowId")||"",_e=n().url.searchParams.get("workflowType")||"",(ge||_e)&&Ze(ge,_e)});const Ge=async()=>{try{r(z,"");const{runId:a}=await yt({namespace:e(T),workflowId:e(S),taskQueue:e(N),workflowType:e(R),input:e(L),summary:e(ae),details:e(le),encoding:F(),messageType:e(ie),searchAttributes:e(Y),identity:Ke,workflowStartDelay:Qt(e(G))});Ve.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:Fe({namespace:e(T),workflow:e(S),run:a})})}catch(a){r(z,(a==null?void 0:a.message)||d("workflows.start-workflow-error")),Ve.push({variant:"error",message:d("workflows.start-workflow-error")})}},Xe=()=>{r(S,Dt()),qe({parameter:"workflowId",value:e(S),url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Ye=async a=>{if(a){const{pollers:_}=await St({namespace:e(T),queue:a});r(B,_.length)}},Ze=async(a,_)=>{var p;const o=await bt({namespace:e(T),workflowId:a,workflowType:_});if(r(L,o.input),e(ne).set(o.encoding),r(ie,o.messageType),r(ae,o.summary),r(le,o.details),o!=null&&o.searchAttributes){const V=Object.keys(O());Object.entries(o.searchAttributes).forEach(([Q,Z])=>{V.includes(Q)&&r(Y,[...e(Y),{label:Q,value:Z,type:O()[Q]}])})}(Object.keys((p=o==null?void 0:o.searchAttributes)!==null&&p!==void 0?p:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(X,!0)},$e=(a,_)=>{const p=a.target.value;qe({parameter:_,value:p,url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},et=a=>{try{return JSON.parse(a),!0}catch{return!1}};J(()=>(e(T),n()),()=>{(a=>r(T,a.namespace))(n().params)}),J(()=>e(z),()=>{r(M,Me(e(z)))}),J(()=>n(),()=>{r(ve,n().url.searchParams.get("taskQueue"))}),J(()=>e(L),()=>{r(we,!e(L)||et(e(L)))}),J(()=>(e(S),e(N),e(R),e(we),n()),()=>{r(Ie,!!e(S)&&!!e(N)&&!!e(R)&&!!e(we)&&!Ct(n()))}),J(()=>e(ve),()=>{Ye(e(ve))}),vt(),He();var ke=Ht(),Pe=u(ke);const tt=l(()=>`${Re({namespace:e(T)})}?${me()}`);be(Pe,{get href(){return e(tt)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(a,_)=>{E();var p=re();C(o=>W(p,o),[()=>d("workflows.back-to-workflows")],l),f(a,p)},$$slots:{default:!0}});var rt=s(Pe,4);fe(rt,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(a,_)=>{var p=Bt(),o=D(p),V=u(o);pe(V,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(S)},set value(t){r(S,t)},$$events:{blur:t=>$e(t,"workflowId")},$$legacy:!0});var Q=s(V,2);he(Q,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Xe},children:(t,A)=>{E();var g=re("Random UUID");f(t,g)},$$slots:{default:!0}}),c(o);var Z=s(o,2),ot=u(Z);pe(ot,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(N)},set value(t){r(N,t)},$$events:{blur:t=>$e(t,"taskQueue")},$$legacy:!0}),c(Z);var Te=s(Z,2);{var st=t=>{const A=l(()=>e(B)>0?"success":"warning"),g=l(()=>e(B)?"Task Queue is Active":"Task Queue is Inactive");Oe(t,{get intent(){return e(A)},get title(){return e(g)},children:(h,ue)=>{var y=Ot(),I=u(y),w=u(I);c(I);var m=s(I,2);const $=l(()=>mt({namespace:e(T),queue:e(N)}));be(m,{get href(){return e($)},newTab:!0,children:(k,j)=>{E();var x=re("View Task Queue");f(k,x)},$$slots:{default:!0}}),c(y),C(k=>W(w,`${e(B)??""}
            ${k??""}`),[()=>Et("Worker",e(B))],l),f(h,y)},$$slots:{default:!0}})};de(Te,t=>{e(B)!==void 0&&t(st)})}var Se=s(Te,2);pe(Se,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(R)},set value(t){r(R,t)},$$events:{blur:t=>$e(t,"workflowType")},$$legacy:!0});var Ae=s(Se,2);ht(Ae,{get input(){return e(L)},set input(t){r(L,t)},get encoding(){return e(ne)},set encoding(t){gt(r(ne,t),"$encoding",v)},get messageType(){return e(ie)},set messageType(t){r(ie,t)},$$legacy:!0});var We=s(Ae,2);{var at=t=>{var A=qt(),g=D(A);fe(g,{class:"flex flex-col gap-2",children:(y,I)=>{var w=Nt(),m=D(w),$=u(m),k=u($,!0);c($),E(2),c(m);var j=s(m,2);const x=l(()=>d("common.add"));Pt(j,{get buttonCopy(){return e(x)},variant:"secondary",get attributesToAdd(){return e(Y)},set attributesToAdd(b){r(Y,b)},$$legacy:!0}),C(b=>W(k,b),[()=>d("search-attributes.custom-search-attributes")],l),f(y,w)},$$slots:{default:!0}});var h=s(g,2);fe(h,{class:"flex flex-col gap-2",children:(y,I)=>{var w=Lt(),m=D(w),$=u(m);const k=l(()=>d("workflows.workflow-start-delay"));ye($,{for:"workflow-start-delay",get label(){return e(k)},class:"text-xl"}),E(2),c(m);var j=s(m,2),x=u(j);const b=l(()=>d("workflows.workflow-start-delay")),ee=l(()=>isNaN(Number(e(G))));pe(x,{id:"workflow-start-delay",get label(){return e(b)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(ee)},get value(){return e(G)},set value(te){r(G,te)},$$legacy:!0});var H=s(x,2),ce=u(H,!0);c(H),c(j),C(te=>W(ce,te),[()=>jt(e(G))],l),f(y,w)},$$slots:{default:!0}});var ue=s(h,2);fe(ue,{class:"flex flex-col gap-2",children:(y,I)=>{var w=Vt(),m=D(w),$=u(m),k=u($),j=u(k,!0);c(k),E(2),c($);var x=s($,2),b=u(x),ee=s(b);const H=l(()=>d("workflows.markdown-description"));Tt(ee,{topRight:!0,width:200,get text(){return e(H)},children:(q,De)=>{Ne(q,{name:"info"})},$$slots:{default:!0}}),c(x),c(m);var ce=s(m,2);const te=l(()=>d("workflows.summary"));ye(ce,{get label(){return e(te)},for:"summary"});var Ee=s(ce,2);Le(Ee,{get content(){return e(ae)},class:"min-h-48",$$events:{change:q=>r(ae,q.detail.value)}});var Ce=s(Ee,2);const dt=l(()=>d("workflows.details"));ye(Ce,{get label(){return e(dt)},for:"details"});var ft=s(Ce,2);Le(ft,{get content(){return e(le)},$$events:{change:q=>r(le,q.detail.value)}}),C((q,De)=>{W(j,q),W(b,`${De??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],l),f(y,w)},$$slots:{default:!0}}),f(t,A)};de(We,t=>{e(X)&&t(at)})}var xe=s(We,2),Qe=u(xe);const lt=l(()=>e(X)?"chevron-up":"chevron-down");he(Qe,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(lt)},$$events:{click:()=>r(X,!e(X))},children:(t,A)=>{E();var g=re();C(h=>W(g,h),[()=>d("common.more-options")],l),f(t,g)},$$slots:{default:!0}});var nt=s(Qe,2);const it=l(()=>!e(Ie));he(nt,{get disabled(){return e(it)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:Ge},children:(t,A)=>{E();var g=re();C(h=>W(g,h),[()=>d("workflows.start-workflow")],l),f(t,g)},$$slots:{default:!0}}),c(xe);var je=s(xe,2);{var ut=t=>{Oe(t,{intent:"error",get title(){return e(z)},children:(A,g)=>{var h=wt(),ue=D(h);{var y=I=>{var w=zt(),m=u(w);const $=l(()=>Fe({namespace:e(T),workflow:e(M).workflowId,run:e(M).runId}));be(m,{get href(){return e($)},class:"inline-flex items-center gap-1",children:(k,j)=>{var x=Rt(),b=D(x);Ne(b,{name:"external-link",class:"h-4 w-4"});var ee=s(b);C(H=>W(ee,` ${H??""}`),[()=>d("workflows.view-running-workflow")],l),f(k,x)},$$slots:{default:!0}}),c(w),f(I,w)};de(ue,I=>{e(M).workflowId&&e(M).runId&&I(y)})}f(A,h)},$$slots:{default:!0}})};de(je,t=>{e(z)&&t(ut)})}var ct=s(je,2);xt(ct,{}),f(a,p)},$$slots:{default:!0}}),c(ke),f(U,ke),Be(),se()}var Ut=P("<!> <!>",1);function Ar(U,K){ze(K,!1);const[v,se]=Je(),n=()=>oe(Ue,"$page",v);He();var F=Ut(),O=D(F);_t(O,{title:"Start Workflow",get url(){return n().url.href}});var me=s(O,2);Jt(me,{}),f(U,F),Be(),se()}export{Ar as component,Sr as universal};
