import{r as ct}from"../chunks/hUONLBj8.js";import{e as qe,c as Qe,i as dt}from"../chunks/DBKaP5vP.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Le,l as L,a as ft,t as I,h as g,c as a,r as $,d,b as Re,n as G,k as X,i as R,j as i,g as e,f as z,s as o,m as n,e as mt}from"../chunks/DSxqszTl.js";import{i as ze}from"../chunks/BcaHj5WR.js";import{s as Be,d as pt,a as Y}from"../chunks/CZBNCVvj.js";import{p as Je}from"../chunks/DCOTX4IR.js";import{P as wt}from"../chunks/DTWo_ajL.js";import{s as O}from"../chunks/CXaSvchK.js";import{i as ne}from"../chunks/BAt4aHTa.js";import{o as vt,w as gt}from"../chunks/Cb3VdkNs.js";import{C as $t}from"../chunks/BL3hqXFS.js";import{P as _t,s as kt,e as ht,g as bt}from"../chunks/CYIP3zHb.js";import{A as yt}from"../chunks/CpNvgPXU.js";import{A as je}from"../chunks/DlVC6YhT.js";import{B as ge}from"../chunks/BhZDDO4d.js";import{C as Oe}from"../chunks/BCh4NEuC.js";import{I as Ce}from"../chunks/Dc8cZy7F.js";import{I as $e}from"../chunks/CbsA-ef4.js";import{L as Ee}from"../chunks/LntrTj2C.js";import{L as _e}from"../chunks/BthsarfL.js";import{E as Fe}from"../chunks/CcUlTmW2.js";import{T as xt}from"../chunks/CFAn1g9i.js";import{t as p}from"../chunks/D2OY9xdY.js";import{g as It}from"../chunks/CGx4LkTK.js";import{c as Pt}from"../chunks/80RifD-7.js";import{t as De}from"../chunks/DjXfOCsk.js";import{g as Tt}from"../chunks/DxrQv2F8.js";import{p as St}from"../chunks/756y7qLl.js";import{u as Ve}from"../chunks/vIvg_m0M.js";import{w as At}from"../chunks/BlggzWwk.js";import{v as Wt}from"../chunks/Dz_GI0CC.js";const Qt=async function({params:B,parent:J}){var l,P;const c=await J();if(((l=c==null?void 0:c.settings)==null?void 0:l.disableWriteActions)||((P=c==null?void 0:c.settings)==null?void 0:P.startWorkflowDisabled)){const{namespace:T}=B;ct(302,qe({namespace:T}))}},kr=Object.freeze(Object.defineProperty({__proto__:null,load:Qt},Symbol.toStringTag,{value:"Module"}));var jt=I('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Ot=I('<div class="flex flex-wrap justify-between"><h3> </h3> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>',1),Ct=I("<!> <!>",1),Et=I("<!> ",1),Ft=I('<div class="mt-2"><!></div>'),Dt=I('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Vt=I('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function qt(B,J){Le(J,!1);const[c,Z]=Be(),l=()=>Y(Je,"$page",c),P=()=>Y(e(re),"$encoding",c),T=()=>Y(Pt,"$customSearchAttributes",c),ie=()=>Y(bt,"$workflowsSearchParams",c),_=n(),N=n(),ue=n(),ce=n(),ke=n(),Ne=Tt();let k=n(""),S=n(""),C=n(""),A=n(""),ee=n(""),te=n(""),re=n(gt("json/plain")),oe=n(""),de="",fe="",E=n(""),F=n(void 0),U=n(!1),H=n([]);function Ue(s){var m,u;if(!s)return{};const r=s.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!r)return{};const W=(m=r[1])===null||m===void 0?void 0:m.trim(),y=(u=r[2])===null||u===void 0?void 0:u.trim();return!W||!y?{}:{workflowId:W,runId:y}}vt(()=>{o(k,l().url.searchParams.get("workflowId")||""),o(S,l().url.searchParams.get("taskQueue")||""),o(C,l().url.searchParams.get("workflowType")||""),de=l().url.searchParams.get("workflowId")||"",fe=l().url.searchParams.get("workflowType")||"",(de||fe)&&Ge(de,fe)});const He=async()=>{try{o(E,"");const{runId:s}=await kt({namespace:e(_),workflowId:e(k),taskQueue:e(S),workflowType:e(C),input:e(A),summary:e(ee),details:e(te),encoding:P(),messageType:e(oe),searchAttributes:e(H),identity:Ne});De.push({variant:"success",duration:5e3,message:p("workflows.start-workflow-success"),link:Qe({namespace:e(_),workflow:e(k),run:s})})}catch(s){o(E,(s==null?void 0:s.message)||p("workflows.start-workflow-error")),De.push({variant:"error",message:p("workflows.start-workflow-error")})}},Ke=()=>{o(k,Wt()),Ve({parameter:"workflowId",value:e(k),url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Me=async s=>{if(s){const{pollers:m}=await It({namespace:e(_),queue:s});o(F,m.length)}},Ge=async(s,m)=>{var u;const r=await ht({namespace:e(_),workflowId:s,workflowType:m});if(o(A,r.input),e(re).set(r.encoding),o(oe,r.messageType),o(ee,r.summary),o(te,r.details),r!=null&&r.searchAttributes){const W=Object.keys(T());Object.entries(r.searchAttributes).forEach(([y,K])=>{W.includes(y)&&o(H,[...e(H),{label:y,value:K,type:T()[y]}])})}(Object.keys((u=r==null?void 0:r.searchAttributes)!==null&&u!==void 0?u:{}).length||r!=null&&r.summary||r!=null&&r.details)&&o(U,!0)},me=(s,m)=>{const u=s.target.value;Ve({parameter:m,value:u,url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Xe=s=>{try{return JSON.parse(s),!0}catch{return!1}};L(()=>(e(_),l()),()=>{(s=>o(_,s.namespace))(l().params)}),L(()=>e(E),()=>{o(N,Ue(e(E)))}),L(()=>l(),()=>{o(ue,l().url.searchParams.get("taskQueue"))}),L(()=>e(A),()=>{o(ce,!e(A)||Xe(e(A)))}),L(()=>(e(k),e(S),e(C),e(ce),l()),()=>{o(ke,!!e(k)&&!!e(S)&&!!e(C)&&!!e(ce)&&!At(l()))}),L(()=>e(ue),()=>{Me(e(ue))}),ft(),ze();var pe=Vt(),he=g(pe);const Ye=i(()=>`${qe({namespace:e(_)})}?${ie()}`);_e(he,{get href(){return e(Ye)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(s,m)=>{G();var u=X();R(r=>O(u,r),[()=>p("workflows.back-to-workflows")],i),d(s,u)},$$slots:{default:!0}});var Ze=a(he,4);Oe(Ze,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(s,m)=>{var u=Dt(),r=z(u),W=g(r);$e(W,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(k)},set value(t){o(k,t)},$$events:{blur:t=>me(t,"workflowId")},$$legacy:!0});var y=a(W,2);ge(y,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Ke},children:(t,h)=>{G();var f=X("Random UUID");d(t,f)},$$slots:{default:!0}}),$(r);var K=a(r,2),et=g(K);$e(et,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(S)},set value(t){o(S,t)},$$events:{blur:t=>me(t,"taskQueue")},$$legacy:!0}),$(K);var be=a(K,2);{var tt=t=>{const h=i(()=>e(F)>0?"success":"warning"),f=i(()=>e(F)?"Task Queue is Active":"Task Queue is Inactive");je(t,{get intent(){return e(h)},get title(){return e(f)},children:(w,D)=>{var V=jt(),v=g(V),b=g(v);$(v);var Q=a(v,2);const M=i(()=>dt({namespace:e(_),queue:e(S)}));_e(Q,{get href(){return e(M)},newTab:!0,children:(x,se)=>{G();var q=X("View Task Queue");d(x,q)},$$slots:{default:!0}}),$(V),R(x=>O(b,`${e(F)??""}
            ${x??""}`),[()=>St("Worker",e(F))],i),d(w,V)},$$slots:{default:!0}})};ne(be,t=>{e(F)!==void 0&&t(tt)})}var ye=a(be,2);$e(ye,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(C)},set value(t){o(C,t)},$$events:{blur:t=>me(t,"workflowType")},$$legacy:!0});var xe=a(ye,2);_t(xe,{get input(){return e(A)},set input(t){o(A,t)},get encoding(){return e(re)},set encoding(t){pt(o(re,t),"$encoding",c)},get messageType(){return e(oe)},set messageType(t){o(oe,t)},$$legacy:!0});var Ie=a(xe,2);{var rt=t=>{var h=Ct(),f=z(h);Oe(f,{class:"flex flex-col gap-2",children:(D,V)=>{var v=Ot(),b=z(v),Q=g(b),M=g(Q,!0);$(Q);var x=a(Q,2),se=g(x),q=a(se);const ae=i(()=>p("workflows.markdown-description"));xt(q,{topRight:!0,width:200,get text(){return e(ae)},children:(j,We)=>{Ce(j,{name:"info"})},$$slots:{default:!0}}),$(x),$(b);var le=a(b,2);const ve=i(()=>p("workflows.summary"));Ee(le,{get label(){return e(ve)},for:"summary"});var Se=a(le,2);Fe(Se,{get content(){return e(ee)},class:"min-h-48",$$events:{change:j=>o(ee,j.detail.value)}});var Ae=a(Se,2);const it=i(()=>p("workflows.details"));Ee(Ae,{get label(){return e(it)},for:"details"});var ut=a(Ae,2);Fe(ut,{get content(){return e(te)},$$events:{change:j=>o(te,j.detail.value)}}),R((j,We)=>{O(M,j),O(se,`${We??""} `)},[()=>p("workflows.user-metadata"),()=>p("workflows.markdown-supported")],i),d(D,v)},$$slots:{default:!0}});var w=a(f,2);yt(w,{get attributesToAdd(){return e(H)},set attributesToAdd(D){o(H,D)},$$legacy:!0}),d(t,h)};ne(Ie,t=>{e(U)&&t(rt)})}var we=a(Ie,2),Pe=g(we);const ot=i(()=>e(U)?"chevron-up":"chevron-down");ge(Pe,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(ot)},$$events:{click:()=>o(U,!e(U))},children:(t,h)=>{G();var f=X();R(w=>O(f,w),[()=>p("common.more-options")],i),d(t,f)},$$slots:{default:!0}});var st=a(Pe,2);const at=i(()=>!e(ke));ge(st,{get disabled(){return e(at)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:He},children:(t,h)=>{G();var f=X();R(w=>O(f,w),[()=>p("workflows.start-workflow")],i),d(t,f)},$$slots:{default:!0}}),$(we);var Te=a(we,2);{var lt=t=>{je(t,{intent:"error",get title(){return e(E)},children:(h,f)=>{var w=mt(),D=z(w);{var V=v=>{var b=Ft(),Q=g(b);const M=i(()=>Qe({namespace:e(_),workflow:e(N).workflowId,run:e(N).runId}));_e(Q,{get href(){return e(M)},class:"inline-flex items-center gap-1",children:(x,se)=>{var q=Et(),ae=z(q);Ce(ae,{name:"external-link",class:"h-4 w-4"});var le=a(ae);R(ve=>O(le,` ${ve??""}`),[()=>p("workflows.view-running-workflow")],i),d(x,q)},$$slots:{default:!0}}),$(b),d(v,b)};ne(D,v=>{e(N).workflowId&&e(N).runId&&v(V)})}d(h,w)},$$slots:{default:!0}})};ne(Te,t=>{e(E)&&t(lt)})}var nt=a(Te,2);$t(nt,{}),d(s,u)},$$slots:{default:!0}}),$(pe),d(B,pe),Re(),Z()}var Lt=I("<!> <!>",1);function hr(B,J){Le(J,!1);const[c,Z]=Be(),l=()=>Y(Je,"$page",c);ze();var P=Lt(),T=z(P);wt(T,{title:"Start Workflow",get url(){return l().url.href}});var ie=a(T,2);qt(ie,{}),d(B,P),Re(),Z()}export{hr as component,kr as universal};
