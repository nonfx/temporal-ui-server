import{r as at}from"../chunks/KjYeVjkE.js";import{e as Ce,b as lt,g as nt}from"../chunks/DlZdva39.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Ee,l as L,a as it,b as Fe,t as R,d as u,g as e,e as w,c as a,f as ee,s as r,m as n,n as z,r as v}from"../chunks/DYX0w8bX.js";import{t as W,a as p,b as B}from"../chunks/Bz76f8pg.js";import{i as Ve}from"../chunks/CZRFLhJG.js";import{s as qe,d as ut,a as J}from"../chunks/CgU0heln.js";import{p as De}from"../chunks/D-OnX6oo.js";import{P as ct}from"../chunks/navuEww_.js";import{s as Q}from"../chunks/CxFVcq4O.js";import{i as de}from"../chunks/B_BuKjdB.js";import{o as ft,w as dt}from"../chunks/DsexP6Wk.js";import{C as pt}from"../chunks/BURqIabo.js";import{P as mt,s as wt,c as vt,e as gt}from"../chunks/CATPq2p9.js";import{A as $t}from"../chunks/Bl109vJ_.js";import{A as Ie}from"../chunks/5uztS7tZ.js";import{B as pe}from"../chunks/DhSBnh2g.js";import{C as Se}from"../chunks/DuX5BOdb.js";import{I as _t}from"../chunks/BSNuev1h.js";import{I as me}from"../chunks/BM3OQknQ.js";import{L as Ae}from"../chunks/WwDu3wGH.js";import{L as Qe}from"../chunks/Dd1DcesQ.js";import{E as We}from"../chunks/XwROSuMI.js";import{T as kt}from"../chunks/BD_sJ-Si.js";import{t as d}from"../chunks/D2OY9xdY.js";import{g as ht}from"../chunks/CeHaqXSI.js";import{b as bt}from"../chunks/BA3ZyxmW.js";import{t as je}from"../chunks/DlxtkSgV.js";import{p as yt}from"../chunks/qEOT7B5E.js";import{u as Oe}from"../chunks/DUMP3unX.js";import{w as xt}from"../chunks/BueE8PyU.js";import{v as Pt}from"../chunks/Dz_GI0CC.js";const Tt=async function({params:j,parent:O}){var l,_;const i=await O();if(((l=i==null?void 0:i.settings)==null?void 0:l.disableWriteActions)||((_=i==null?void 0:i.settings)==null?void 0:_.startWorkflowDisabled)){const{namespace:k}=j;at(302,Ce({namespace:k}))}},pr=Object.freeze(Object.defineProperty({__proto__:null,load:Tt},Symbol.toStringTag,{value:"Module"}));var It=W('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),St=W('<div class="flex flex-wrap justify-between"><h3> </h3> <p class="flex items-center gap-1 text-sm text-subtle"> <!></p></div> <!> <!> <!> <!>',1),At=W("<!> <!>",1),Qt=W('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Wt=W('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function jt(j,O){Ee(O,!1);const[i,M]=qe(),l=()=>J(De,"$page",i),_=()=>J(e(H),"$encoding",i),k=()=>J(bt,"$customSearchAttributes",i),te=()=>J(gt,"$workflowsSearchParams",i),g=n(),re=n(),oe=n(),we=n();let m=n(""),h=n(""),T=n(""),b=n(""),N=n(""),U=n(""),H=n(dt("json/plain")),K=n(""),se="",ae="",G=n(""),I=n(void 0),C=n(!1),E=n([]);ft(()=>{r(m,l().url.searchParams.get("workflowId")||""),r(h,l().url.searchParams.get("taskQueue")||""),r(T,l().url.searchParams.get("workflowType")||""),se=l().url.searchParams.get("workflowId")||"",ae=l().url.searchParams.get("workflowType")||"",(se||ae)&&Be(se,ae)});const Le=async()=>{try{r(G,"");const{runId:s}=await wt({namespace:e(g),workflowId:e(m),taskQueue:e(h),workflowType:e(T),input:e(b),summary:e(N),details:e(U),encoding:_(),messageType:e(K),searchAttributes:e(E)});je.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:lt({namespace:e(g),workflow:e(m),run:s})})}catch(s){r(G,(s==null?void 0:s.message)||d("workflows.start-workflow-error")),je.push({variant:"error",message:d("workflows.start-workflow-error")})}},Re=()=>{r(m,Pt()),Oe({parameter:"workflowId",value:e(m),url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},ze=async s=>{if(s){const{pollers:$}=await ht({namespace:e(g),queue:s});r(I,$.length)}},Be=async(s,$)=>{var f;const o=await vt({namespace:e(g),workflowId:s,workflowType:$});if(r(b,o.input),e(H).set(o.encoding),r(K,o.messageType),r(N,o.summary),r(U,o.details),o!=null&&o.searchAttributes){const X=Object.keys(k());Object.entries(o.searchAttributes).forEach(([F,V])=>{X.includes(F)&&r(E,[...e(E),{label:F,value:V,type:k()[F]}])})}(Object.keys((f=o==null?void 0:o.searchAttributes)!==null&&f!==void 0?f:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(C,!0)},le=(s,$)=>{const f=s.target.value;Oe({parameter:$,value:f,url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Je=s=>{try{return JSON.parse(s),!0}catch{return!1}};L(()=>(e(g),l()),()=>{(s=>r(g,s.namespace))(l().params)}),L(()=>l(),()=>{r(re,l().url.searchParams.get("taskQueue"))}),L(()=>e(b),()=>{r(oe,!e(b)||Je(e(b)))}),L(()=>(e(m),e(h),e(T),e(oe),l()),()=>{r(we,!!e(m)&&!!e(h)&&!!e(T)&&!!e(oe)&&!xt(l()))}),L(()=>e(re),()=>{ze(e(re))}),it(),Ve();var ne=Wt(),ve=w(ne);const Me=u(()=>`${Ce({namespace:e(g)})}?${te()}`);Qe(ve,{get href(){return e(Me)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(s,$)=>{z();var f=B();R(o=>Q(f,o),[()=>d("workflows.back-to-workflows")],u),p(s,f)},$$slots:{default:!0}});var Ne=a(ve,4);Se(Ne,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(s,$)=>{var f=Qt(),o=ee(f),X=w(o);me(X,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(m)},set value(t){r(m,t)},$$events:{blur:t=>le(t,"workflowId")},$$legacy:!0});var F=a(X,2);pe(F,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Re},children:(t,y)=>{z();var c=B("Random UUID");p(t,c)},$$slots:{default:!0}}),v(o);var V=a(o,2),Ue=w(V);me(Ue,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(h)},set value(t){r(h,t)},$$events:{blur:t=>le(t,"taskQueue")},$$legacy:!0}),v(V);var ge=a(V,2);{var He=t=>{const y=u(()=>e(I)>0?"success":"warning"),c=u(()=>e(I)?"Task Queue is Active":"Task Queue is Inactive");Ie(t,{get intent(){return e(y)},get title(){return e(c)},children:(x,Y)=>{var Z=It(),S=w(Z),q=w(S);v(S);var D=a(S,2);const ue=u(()=>nt({namespace:e(g),queue:e(h)}));Qe(D,{get href(){return e(ue)},newTab:!0,children:(A,ce)=>{z();var fe=B("View Task Queue");p(A,fe)},$$slots:{default:!0}}),v(Z),R(A=>Q(q,`${e(I)??""}
            ${A??""}`),[()=>yt("Worker",e(I))],u),p(x,Z)},$$slots:{default:!0}})};de(ge,t=>{e(I)!==void 0&&t(He)})}var $e=a(ge,2);me($e,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(T)},set value(t){r(T,t)},$$events:{blur:t=>le(t,"workflowType")},$$legacy:!0});var _e=a($e,2);mt(_e,{get input(){return e(b)},set input(t){r(b,t)},get encoding(){return e(H)},set encoding(t){ut(r(H,t),"$encoding",i)},get messageType(){return e(K)},set messageType(t){r(K,t)},$$legacy:!0});var ke=a(_e,2);{var Ke=t=>{var y=At(),c=ee(y);Se(c,{class:"flex flex-col gap-2",children:(Y,Z)=>{var S=St(),q=ee(S),D=w(q),ue=w(D,!0);v(D);var A=a(D,2),ce=w(A),fe=a(ce);const tt=u(()=>d("workflows.markdown-description"));kt(fe,{topRight:!0,width:200,get text(){return e(tt)},children:(P,Te)=>{_t(P,{name:"info"})},$$slots:{default:!0}}),v(A),v(q);var ye=a(q,2);const rt=u(()=>d("workflows.summary"));Ae(ye,{get label(){return e(rt)},for:"summary"});var xe=a(ye,2);We(xe,{get content(){return e(N)},class:"min-h-48",$$events:{change:P=>r(N,P.detail.value)}});var Pe=a(xe,2);const ot=u(()=>d("workflows.details"));Ae(Pe,{get label(){return e(ot)},for:"details"});var st=a(Pe,2);We(st,{get content(){return e(U)},$$events:{change:P=>r(U,P.detail.value)}}),R((P,Te)=>{Q(ue,P),Q(ce,`${Te??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],u),p(Y,S)},$$slots:{default:!0}});var x=a(c,2);$t(x,{get attributesToAdd(){return e(E)},set attributesToAdd(Y){r(E,Y)},$$legacy:!0}),p(t,y)};de(ke,t=>{e(C)&&t(Ke)})}var ie=a(ke,2),he=w(ie);const Ge=u(()=>e(C)?"chevron-up":"chevron-down");pe(he,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(Ge)},$$events:{click:()=>r(C,!e(C))},children:(t,y)=>{z();var c=B();R(x=>Q(c,x),[()=>d("common.more-options")],u),p(t,c)},$$slots:{default:!0}});var Xe=a(he,2);const Ye=u(()=>!e(we));pe(Xe,{get disabled(){return e(Ye)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:Le},children:(t,y)=>{z();var c=B();R(x=>Q(c,x),[()=>d("workflows.start-workflow")],u),p(t,c)},$$slots:{default:!0}}),v(ie);var be=a(ie,2);{var Ze=t=>{Ie(t,{intent:"error",get title(){return e(G)}})};de(be,t=>{e(G)&&t(Ze)})}var et=a(be,2);pt(et,{}),p(s,f)},$$slots:{default:!0}}),v(ne),p(j,ne),Fe(),M()}var Ot=W("<!> <!>",1);function mr(j,O){Ee(O,!1);const[i,M]=qe(),l=()=>J(De,"$page",i);Ve();var _=Ot(),k=ee(_);ct(k,{title:"Start Workflow",get url(){return l().url.href}});var te=a(k,2);jt(te,{}),p(j,_),Fe(),M()}export{mr as component,pr as universal};
