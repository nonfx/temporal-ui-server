import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as K,ax as r,aL as te,ae as re,g as e,s as oe,e as x,r as y,b as M,f as I,c as k,t as E,n as se,d as ae}from"../chunks/CVkC3v6g.js";import{t as b,a as u,c as B,b as ne}from"../chunks/CXa2DXXa.js";import{i as le}from"../chunks/B3G23GpA.js";import{a as g,s as N}from"../chunks/B71MWTBs.js";import{p as ie}from"../chunks/BlTZtavH.js";import{P as ce}from"../chunks/CzIAgOFi.js";import{t as o}from"../chunks/D2OY9xdY.js";import{W as me}from"../chunks/DJN_qYyh.js";import{s as F}from"../chunks/DUPvQxLd.js";import{a as fe}from"../chunks/Bp8CRxSd.js";import{i as G}from"../chunks/DpQPgcBL.js";import{p as H}from"../chunks/CEC5gFID.js";import{A as pe}from"../chunks/Bao8vGeu.js";import{C as ue}from"../chunks/yMkT9UdU.js";import{E as J}from"../chunks/B4jGSy-b.js";import{L as ve}from"../chunks/LH3G9Yqj.js";import{S as Q}from"../chunks/CF9DRvzi.js";import{g as de}from"../chunks/ClUKdQJJ.js";import{a as we}from"../chunks/BaP1uuNe.js";import{f as ke,t as _e,r as ge}from"../chunks/BogN5CJj.js";import{w as $e,r as he}from"../chunks/DwKzMZUG.js";var xe=b('<!> <p> </p> <div class="my-2 flex h-full items-start"><!></div>',1),ye=b('<div class="flex flex-col gap-2"><!> <!> <!></div>'),be=b("<p> <!> </p>"),Te=b("<section><!></section>");function Re(W,L){K(L,!0);const[v,U]=N(),$=()=>g($e,"$workflowRun",v),T=()=>g(he,"$refresh",v),R=()=>g(_e,"$timeFormat",v),P=()=>g(ge,"$relativeTime",v),h=()=>g(we,"$authUser",v);let n=r(()=>$().workflow),S=r(()=>$().workers);const j=r(()=>H.params.namespace);let z=te(void 0),O=r(()=>ke(T()?new Date(T()):new Date,R(),{relative:P(),abbrFormat:!0}));const V=()=>{var s;return de({workflow:e(n),namespace:e(j)},(s=H.data)===null||s===void 0?void 0:s.settings,h()===null||h()===void 0?void 0:h().accessToken)};re(()=>{!(e(n)===null||e(n)===void 0)&&e(n).isRunning&&oe(z,V(),!0)});var A=Te(),X=x(A);{var Y=s=>{var d=B(),_=I(d);fe(_,()=>e(z),l=>{var a=ye(),i=x(a);Q(i,{class:"h-16 w-1/3 rounded-sm"});var c=k(i,2);Q(c,{class:"h-3 w-32"});var m=k(c,2);Q(m,{class:"h-48 w-full rounded-sm"}),y(a),u(l,a)},(l,a)=>{var i=xe(),c=I(i);const m=r(()=>o("workflows.call-stack-alert"));pe(c,{intent:"info",icon:"info",get title(){return e(m)},class:"mb-4 w-fit"});var t=k(c,2),w=x(t);y(t);var f=k(t,2),C=x(f);const p=r(()=>o("common.copy-icon-title")),q=r(()=>o("common.copy-success-icon-title"));ue(C,{get content(){return e(a)},language:"text",testId:"query-call-stack",get copyIconTitle(){return e(p)},get copySuccessIconTitle(){return e(q)}}),y(f),E(D=>F(w,`${D??""}
        ${e(O)??""}`),[()=>o("workflows.call-stack-at")]),u(l,i)},(l,a)=>{const i=r(()=>o("common.error-occurred")),c=r(()=>o("workflows.no-workers-running-message")),m=r(()=>{var t;return(t=e(a))==null?void 0:t.message});J(l,{get title(){return e(i)},get content(){return e(c)},get error(){return e(m)}})}),u(s,d)},Z=s=>{const d=r(()=>o("workflows.call-stack-empty-state"));J(s,{get title(){return e(d)},testId:"query-call-stack-empty",children:(_,l)=>{var a=B(),i=I(a);{var c=m=>{var t=be(),w=x(t,!0),f=k(w);ve(f,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(p,q)=>{se();var D=ne();E(ee=>F(D,ee),[()=>o("workflows.call-stack-link")]),u(p,D)},$$slots:{default:!0}});var C=k(f,1,!0);y(t),E((p,q)=>{F(w,p),F(C,q)},[()=>o("workflows.call-stack-link-preface"),()=>{var p;return o("workflows.call-stack-link-postface",{taskQueue:(p=e(n))==null?void 0:p.taskQueue})}]),u(m,t)};G(i,m=>{var t,w,f;(t=e(n))!=null&&t.isRunning&&((f=(w=e(S))==null?void 0:w.pollers)==null?void 0:f.length)===0&&m(c)})}u(_,a)},$$slots:{default:!0}})};G(X,s=>{var d,_,l;(d=e(n))!=null&&d.isRunning&&((l=(_=e(S))==null?void 0:_.pollers)==null?void 0:l.length)>0?s(Y):s(Z,!1)})}y(A),u(W,A),M(),U()}var Pe=b("<!> <!>",1);function Xe(W,L){K(L,!1);const[v,U]=N(),$=()=>g(ie,"$page",v),T=$().params.workflow;le();var R=Pe(),P=I(R);const h=ae(()=>`${o("workflows.call-stack-tab")} | ${T}`);ce(P,{get title(){return e(h)},get url(){return $().url.href}});var n=k(P,2);me(n,{children:(S,j)=>{Re(S,{})},$$slots:{default:!0}}),u(W,R),M(),U()}export{Xe as component};
